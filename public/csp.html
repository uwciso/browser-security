<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/styles.css" />
  <title>Secure Coding 102 Exercises - CSP</title>
</head>
<body>

  <div class="banner main">
    <h1>Content Security Policy (CSP)<span class="resource"><a href="index.html">All Exercises</a></span></h1>
  </div>

  <div class="instr-header">
    <h2>Instructions</h2>
    <ol>
      <li>
        Open the app.js file in a text editor.
      </li>
      <li>
        On another browser tab, open the <a href="assets.html" target="_blank">assets page</a> along with Dev Tools.
      </li>
      <li>
        For each challenge below, create a corresponding content security policy by editing the <a href="https://github.com/uwciso/browser-security/blob/master/app.js#L9-L10" target="blank"><code>csp_directives</code></a> object in the app.js file (refer to the <a href="https://helmetjs.github.io/docs/csp/" target="0">Helmet.js docs</a> for syntax guidance). Note that you'll also need to uncomment the <a href="https://github.com/uwciso/browser-security/blob/master/app.js#L15-L19" target="blank"><code>app.use</code></a> statement to begin using CSP for all requests. Observe that before activating any CSP, <i>all</i> resources are loaded/executed by the page. 
      </li>
      <li>
        Check the results of each CSP modification by reloading the assets page, and observing which assets were loaded/executed.
      </li>
    </ol>
  </div>

  <div class="csp-challenges">
    <div class="written-instr">
      <h2>Challenges</h2>
      <ol>
        <li>Set a default policy which allows <i>only</i> local assets to be loaded (all inline scripts should be blocked).</li>
        <li>In addition to the local stylesheet and (non-inline) scripts, allow the Bootstrap stylesheet to be loaded from its CDN. When loading successfully, is this a CORS request? Why or why not?</li>
        <li>In addition to all stylesheets and local (non-inline) scripts, allow <i>all</i> images to be loaded.</li>
        <li>In addition to all stylesheets and images, allow <i>only</i> scripts from the code.jquery.com CDN.</li>
        <li>Now, allow scripts from the jQuery CDN as well as any local scripts (but still block all inline scripts).</li>
        <li>In addition to scripts from the jQuery CDN and local scripts, allow inline script A by using a hash (HINT: When refusing to run a script, Chrome Dev Tools will provide the base64 value of the script's SHA256 hash in its console error message).</li>
        <li>Find two ways in which to allow <i>both</i> inline scripts as well as all other assets. Is one method preferable over the other?</li>
      </ol>
    </div>
    <div class="table-instr">
      <table class="challenges">
        <thead>
          <tr>
            <th></th>
            <th>Inline Script A</th>
            <th>Inline Script B</th>
            <th>Local Script</th>
            <th>Local Image</th>
            <th>External Image</th>
            <th>Local Stylesheet</th>
            <th>Bootstrap Stylesheet (via CDN)</th>
            <th>jQuery (via CDN)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>1</th>
            <td class="no"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="no"></td>
            <td class="no"></td>
          </tr>
          <tr>
            <th>2</th>
            <td class="no"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="no"></td>
          </tr>
          <tr>
            <th>3</th>
            <td class="no"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="no"></td>
          </tr>
          <tr>
            <th>4</th>
            <td class="no"></td>
            <td class="no"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
          </tr>
          <tr>
            <th>5</th>
            <td class="no"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
          </tr>
          <tr>
            <th>6</th>
            <td class="yes"></td>
            <td class="no"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
          </tr>
          <tr>
            <th>7</th>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
            <td class="yes"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <h2>Resources</h2>
  <ul>
    <li>
      <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="0">CSP on MDN</a>
    </li>
    <li>
      <a href="https://helmetjs.github.io/docs/csp/" target="0">Modifying CSP directives with Helmet.js</a> 
    </li>
  </ul>
  <h2>Solutions</h2>
  <p>To see solutions to each CSP challenge, view the <a href="https://github.com/uwciso/browser-security/blob/master/solutions.js" target="0">solutions.js</a> file.</p>
</body>
</html>
